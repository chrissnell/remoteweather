<!DOCTYPE html>
<html data-wf-page="portal" data-wf-site="weather-portal">
<head>
  <meta charset="utf-8">
  <title>Weather Management Portal</title>
  <meta content="Weather Management Portal" name="description">
  <meta content="Weather Management Portal" property="og:title">
  <meta content="Weather Management Portal" property="og:description">
  <meta content="Weather Management Portal" property="twitter:title">
  <meta content="Weather Management Portal" property="twitter:description">
  <meta property="og:type" content="website">
  <meta content="summary_large_image" name="twitter:card">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/weather-station.webflow.css" rel="stylesheet" type="text/css">
  <link href="css/portal.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Roboto:100,100italic,300,300italic,regular,italic,500,500italic,700,700italic,900,900italic:latin,latin-ext"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
  
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  
  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  
  <!-- Portal JavaScript loaded via API -->
  <script src="js/moment.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    // Load portal JavaScript via REST API
    (function() {
      const script = document.createElement('script');
      script.type = 'text/javascript';
      
      fetch('/api/portal-js')
        .then(response => {
          if (!response.ok) {
            throw new Error('Failed to load portal code');
          }
          return response.text();
        })
        .then(jsCode => {
          script.textContent = jsCode;
          document.head.appendChild(script);
        })
        .catch(error => {
          console.error('Error loading portal:', error);
          document.getElementById('error-message').style.display = 'block';
          document.getElementById('loading-indicator').style.display = 'none';
        });
    })();
  </script>
</head>
<body class="body">
  <div class="portal-container">
    <div class="portal-header">
      <h1 class="portal-title">Weather Management Portal</h1>
      <div class="portal-controls">
        <div id="refresh-status" class="refresh-status">Loading...</div>
      </div>
    </div>
    
    <div class="portal-content">
      <div id="map-container" class="map-container">
        <div id="weather-map" class="weather-map"></div>
      </div>
      
      <div id="station-list" class="station-sidebar">
        <h3>Weather Stations</h3>
        <div id="station-list-content" class="station-list-content">
          <!-- Station list will be populated by JavaScript -->
        </div>
        
        <div class="data-display-controls">
          <h4>Display Data</h4>
          <div class="data-display-buttons">
            <button id="display-temperature" class="data-display-button active" data-type="temperature">
              Temperature
            </button>
            <button id="display-humidity" class="data-display-button" data-type="humidity">
              Humidity
            </button>
            <button id="display-rainfall" class="data-display-button" data-type="rainfall">
              24hr Rainfall
            </button>
            <button id="display-snow" class="data-display-button" data-type="snow">
              Snow Depth
            </button>
            <button id="display-barometer" class="data-display-button" data-type="barometer">
              Barometer
            </button>
            <button id="display-wind" class="data-display-button" data-type="wind">
              Wind Speed
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Loading indicator -->
  <div id="loading-indicator" class="loading-indicator">
    <div class="loading-spinner"></div>
    <p>Loading weather data...</p>
  </div>
  
  <!-- Error message -->
  <div id="error-message" class="error-message" style="display: none;">
    <p>Unable to load weather data. Please try again later.</p>
  </div>
  
  <script src="js/webflow.js" type="text/javascript"></script>
</body>
</html> 
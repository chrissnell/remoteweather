<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RemoteWeather Management</title>
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel="stylesheet">
  <!-- Core stylesheet -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="header-bar">
    <h1 class="app-title">RemoteWeather Management</h1>
  </header>

  <main class="main-layout">
    <!-- Vertical tab navigation -->
    <nav class="side-nav" id="side-nav">
      <button class="tab-button active" data-target="ws-pane">Weather Stations</button>
      <button class="tab-button" data-target="ctrl-pane">Controllers</button>
      <button class="tab-button" data-target="storage-pane">Storage</button>
      <button class="tab-button" data-target="websites-pane">Weather Websites</button>
    </nav>

    <!-- Content area -->
    <section class="content-area">
      <!-- Weather Stations Pane -->
      <div class="tab-pane" id="ws-pane">
        <header class="pane-header">
          <h2>Weather Stations</h2>
          <button id="add-station-btn" class="primary-btn">+ Add Station</button>
        </header>
        <div id="ws-list" class="list-container">Loading…</div>

        <!-- Modal for add/edit station -->
        <div id="station-modal" class="modal hidden">
          <div class="modal-content">
            <header class="modal-header">
              <h3 id="modal-title">Add Station</h3>
              <button class="close-btn" id="modal-close">×</button>
            </header>

            <form id="station-form" class="station-form">
              <input type="hidden" id="form-mode" value="add" />

              <label>
                Name
                <input type="text" id="station-name" required />
              </label>

              <label>
                Type
                <select id="station-type" required>
                  <option value="davis">Davis Instruments</option>
                  <option value="campbellscientific">Campbell Scientific</option>
                  <option value="snowgauge">Snow Gauge</option>
                </select>
              </label>

              <label>
                Connection
                <select id="connection-type" required>
                  <option value="serial">Serial</option>
                  <option value="network">Network</option>
                </select>
              </label>

              <fieldset id="serial-fieldset" class="conn-fieldset hidden">
                <legend>Serial Connection</legend>
                <label>
                  Device Path
                  <select id="serial-device">
                    <option value="">Select a serial port...</option>
                  </select>
                </label>
                <label>
                  Baud
                  <input type="number" id="serial-baud" placeholder="9600" />
                </label>
              </fieldset>

              <fieldset id="network-fieldset" class="conn-fieldset hidden">
                <legend>Network Connection</legend>
                <label>
                  Hostname
                  <input type="text" id="net-hostname" placeholder="192.168.1.50" />
                </label>
                <label>
                  Port
                  <input type="text" id="net-port" placeholder="3001" />
                </label>
              </fieldset>

              <div id="snow-options" class="snow-options hidden">
                <label>
                  Base Snow Distance (mm)
                  <input type="number" id="snow-distance" />
                </label>
              </div>

              <fieldset class="conn-fieldset">
                <legend>Station Location</legend>
                <label>
                  Latitude
                  <input type="number" id="solar-latitude" step="0.0001" placeholder="40.7128" />
                </label>
                <label>
                  Longitude
                  <input type="number" id="solar-longitude" step="0.0001" placeholder="-74.0060" />
                </label>
                <label>
                  Altitude (meters)
                  <input type="number" id="solar-altitude" placeholder="10" />
                </label>
              </fieldset>

              <fieldset class="conn-fieldset">
                <legend>APRS Configuration</legend>
                <label class="checkbox-label">
                  <input type="checkbox" id="aprs-enabled" /> Enable APRS
                </label>
                <div id="aprs-config-fields" class="hidden">
                  <label>
                    APRS Callsign
                    <input type="text" id="aprs-callsign" placeholder="N0CALL" />
                  </label>
                  <label>
                    APRS Passcode
                    <input type="text" id="aprs-passcode" placeholder="12345" />
                  </label>
                  <p class="help-text">APRS will use the latitude and longitude from Station Location above.</p>
                </div>
              </fieldset>

              <footer class="modal-footer">
                <button type="submit" class="primary-btn" id="save-station-btn">Save</button>
                <button type="button" class="secondary-btn" id="cancel-station-btn">Cancel</button>
              </footer>
            </form>
          </div>
        </div>
      </div>

      <!-- Controllers Pane -->
      <div class="tab-pane hidden" id="ctrl-pane">
        <div class="pane-header">
          <h2>Controllers</h2>
          <button class="primary-btn" id="add-controller-btn">+ Add Controller</button>
        </div>
        <div id="controller-list" class="list-container">Loading…</div>
      </div>

      <!-- Storage Pane -->
      <div class="tab-pane hidden" id="storage-pane">
        <div class="pane-header">
          <h2>Storage</h2>
          <button class="primary-btn" id="add-storage-btn">Add Storage</button>
        </div>
        <div id="storage-list" class="list-container">Loading…</div>
      </div>

      <!-- Weather Websites Pane -->
      <div class="tab-pane hidden" id="websites-pane">
        <div class="pane-header">
          <h2>Weather Websites</h2>
          <button class="primary-btn" id="add-website-btn">Add Website</button>
        </div>
        <div id="website-list" class="list-container">Loading…</div>
      </div>
    </section>
  </main>

  <!-- Storage Modal -->
  <div id="storage-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="storage-modal-title">Add Storage Backend</h3>
        <button class="close-btn" id="storage-modal-close">×</button>
      </div>
      <form id="storage-form" class="station-form">
        <input type="hidden" id="storage-form-mode" value="add" />
        <label>
          Storage Type
          <select id="storage-type">
            <option value="timescaledb">TimescaleDB</option>
            <option value="grpc">gRPC</option>
          </select>
        </label>
        <div id="timescaledb-fields">
          <label>
            Connection String
            <input type="text" id="timescale-conn" placeholder="host=localhost port=5432 dbname=..." />
          </label>
        </div>
        <div id="grpc-fields" class="hidden">
          <label>
            Listen Port
            <input type="number" id="grpc-port" placeholder="5555" />
          </label>
          <label>
            Pull From Device
            <select id="grpc-device-select"></select>
          </label>
        </div>
        <div class="modal-footer">
          <button type="button" class="secondary-btn" id="cancel-storage-btn">Cancel</button>
          <button type="submit" class="primary-btn" id="save-storage-btn">Save</button>
        </div>
      </form>
    </div>
  </div>
  <!-- end storage modal -->

  <!-- Controller Modal -->
  <div id="controller-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="controller-modal-title">Add Controller</h3>
        <button class="close-btn" id="controller-modal-close">×</button>
      </div>
      <form id="controller-form" class="station-form">
        <input type="hidden" id="controller-form-mode" value="add" />
        <label>
          Controller Type
          <select id="controller-type">
            <option value="pwsweather">PWS Weather</option>
            <option value="weatherunderground">Weather Underground</option>
            <option value="aerisweather">Aeris Weather</option>
            <option value="rest">REST Server</option>
            <option value="management">Management API</option>
            <option value="aprs">APRS</option>
          </select>
        </label>
        
        <!-- PWS Weather fields -->
        <div id="pwsweather-fields" class="controller-fields hidden">
          <label>
            Station ID
            <input type="text" id="pws-station-id" placeholder="STATION123" />
          </label>
          <label>
            API Key
            <input type="password" id="pws-api-key" placeholder="your-api-key" />
          </label>
          <label>
            API Endpoint
            <input type="text" id="pws-api-endpoint" value="https://www.pwsweather.com/pwsweather/restapi" />
          </label>
          <label>
            Upload Interval
            <input type="text" id="pws-upload-interval" value="5m" />
          </label>
          <label>
            Pull From Device
            <select id="pws-device-select"></select>
          </label>
        </div>
        
        <!-- Weather Underground fields -->
        <div id="weatherunderground-fields" class="controller-fields hidden">
          <label>
            Station ID
            <input type="text" id="wu-station-id" placeholder="STATION123" />
          </label>
          <label>
            API Key
            <input type="password" id="wu-api-key" placeholder="your-api-key" />
          </label>
          <label>
            API Endpoint
            <input type="text" id="wu-api-endpoint" value="https://rtupdate.wunderground.com/weatherstation/updateweatherstation.php" />
          </label>
          <label>
            Upload Interval
            <input type="text" id="wu-upload-interval" placeholder="5m" />
          </label>
          <label>
            Pull From Device
            <select id="wu-device-select"></select>
          </label>
        </div>
        
        <!-- Aeris Weather fields -->
        <div id="aerisweather-fields" class="controller-fields hidden">
          <label>
            API Client ID
            <input type="text" id="aeris-client-id" placeholder="your-client-id" />
          </label>
          <label>
            API Client Secret
            <input type="password" id="aeris-client-secret" placeholder="your-client-secret" />
          </label>
          <label>
            API Endpoint
            <input type="text" id="aeris-api-endpoint" value="https://api.aerisapi.com" />
          </label>
          <label>
            Latitude
            <input type="number" step="0.000001" id="aeris-latitude" placeholder="44.9778" />
          </label>
          <label>
            Longitude
            <input type="number" step="0.000001" id="aeris-longitude" placeholder="-93.2650" />
          </label>
        </div>
        
        <!-- REST Server fields -->
        <div id="rest-fields" class="controller-fields hidden">
          <label>
            HTTP Port
            <input type="number" id="rest-http-port" value="80" />
          </label>
          <label>
            HTTPS Port (optional)
            <input type="number" id="rest-https-port" value="443" />
          </label>
          <label>
            Listen Address (optional)
            <input type="text" id="rest-listen-addr" value="0.0.0.0" />
          </label>
          <label>
            TLS Certificate Path (optional)
            <input type="text" id="rest-tls-cert" placeholder="/path/to/cert.pem" />
          </label>
          <label>
            TLS Key Path (optional)
            <input type="text" id="rest-tls-key" placeholder="/path/to/key.pem" />
          </label>
        </div>
        
        <!-- Management API fields -->
        <div id="management-fields" class="controller-fields hidden">
          <label>
            Port
            <input type="number" id="mgmt-port" placeholder="8081" />
          </label>
          <label>
            Listen Address
            <input type="text" id="mgmt-listen-addr" value="127.0.0.1" />
          </label>
          <label>
            TLS Certificate Path (optional)
            <input type="text" id="mgmt-cert" placeholder="/path/to/cert.pem" />
          </label>
          <label>
            TLS Key Path (optional)
            <input type="text" id="mgmt-key" placeholder="/path/to/key.pem" />
          </label>
        </div>
        
        <!-- APRS fields -->
        <div id="aprs-fields" class="controller-fields hidden">
          <label>
            APRS-IS Server
            <input type="text" id="aprs-server" value="noam.aprs2.net:14580" />
          </label>
        </div>
        
        <div class="modal-footer">
          <button type="button" class="secondary-btn" id="cancel-controller-btn">Cancel</button>
          <button type="submit" class="primary-btn" id="save-controller-btn">Save</button>
        </div>
      </form>
    </div>
  </div>
  <!-- end controller modal -->

  <!-- Weather Website Modal -->
  <div id="website-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="website-modal-title">Add Weather Website</h3>
        <button class="close-btn" id="website-modal-close">×</button>
      </div>
      <form id="website-form" class="station-form">
        <input type="hidden" id="website-form-mode" value="add" />
        <input type="hidden" id="website-edit-id" value="" />
        
        <label>
          Website Name
          <input type="text" id="website-name" placeholder="Weather Station Website" required />
        </label>
        
        <label>
          Page Title
          <input type="text" id="website-page-title" placeholder="My Weather Station" />
        </label>
        
        <label>
          About Station HTML
          <textarea id="website-about-html" rows="4" placeholder="<p>Welcome to my weather station...</p>"></textarea>
        </label>
        
        <label>
          Weather Station Device
          <select id="website-device" required>
            <option value="">Select a device...</option>
          </select>
        </label>
        
        <label>
          Snow Device
          <select id="website-snow-device">
            <option value="">None</option>
          </select>
        </label>
        
        <label>
          Hostname
          <input type="text" id="website-hostname" placeholder="weather.example.com" required />
        </label>
        
        <fieldset>
          <legend>TLS Configuration (Optional)</legend>
          <label>
            TLS Certificate Path
            <input type="text" id="website-tls-cert" placeholder="/path/to/cert.pem" />
          </label>
          <label>
            TLS Key Path
            <input type="text" id="website-tls-key" placeholder="/path/to/key.pem" />
          </label>
        </fieldset>
        
        <div class="modal-footer">
          <button type="button" class="secondary-btn" id="cancel-website-btn">Cancel</button>
          <button type="submit" class="primary-btn" id="save-website-btn">Save</button>
        </div>
      </form>
    </div>
  </div>
  <!-- end website modal -->

  <script src="js/management.js"></script>
</body>
</html> 